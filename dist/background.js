(()=>{var e,r={15340:()=>{},18950:()=>{},29198:(e,r,t)=>{"use strict";var a,n;!function(e){e.ETHEREUM_MAINNET="ethereum-mainnet",e.ETHEREUM_SEPOLIA="ethereum-sepolia",e.POLYGON="polygon",e.BSC="bsc"}(a||(a={})),function(e){e.CREATE_WALLET="CREATE_WALLET",e.RESTORE_WALLET="RESTORE_WALLET",e.UNLOCK_WALLET="UNLOCK_WALLET",e.LOCK_WALLET="LOCK_WALLET",e.GET_BALANCE="GET_BALANCE",e.SEND_TRANSACTION="SEND_TRANSACTION",e.GET_TRANSACTIONS="GET_TRANSACTIONS",e.CREATE_ACCOUNT="CREATE_ACCOUNT",e.SWITCH_ACCOUNT="SWITCH_ACCOUNT",e.GET_ACCOUNTS="GET_ACCOUNTS",e.CREATE_DID="CREATE_DID",e.RESOLVE_DID="RESOLVE_DID",e.STORE_CREDENTIAL="STORE_CREDENTIAL",e.GET_CREDENTIALS="GET_CREDENTIALS",e.VERIFY_CREDENTIAL="VERIFY_CREDENTIAL",e.CREATE_PRESENTATION="CREATE_PRESENTATION",e.EXPORT_CREDENTIALS="EXPORT_CREDENTIALS",e.IMPORT_CREDENTIALS="IMPORT_CREDENTIALS",e.SIGN_MESSAGE="SIGN_MESSAGE",e.SIGN_CHALLENGE="SIGN_CHALLENGE",e.REQUEST_ACCOUNTS="REQUEST_ACCOUNTS",e.REQUEST_PRESENTATION="REQUEST_PRESENTATION",e.REQUEST_SIGNATURE="REQUEST_SIGNATURE"}(n||(n={}));var s=t(90749),o=t(81587),c=t.n(o),i=t(21396),l=t.n(i),d=t(5137);const u="m/44'/60'/0'/0/0",E="m/44'/60'/0'/0/1";function f(e){return s.JB(e)}function p(e,r){if(!f(e))throw new Error("Invalid mnemonic phrase");const t=s.kw(e),a=c().fromMasterSeed(t).derive(r);if(!a.privateKey)throw new Error("Failed to derive private key");return"0x"+a.privateKey.toString("hex")}function T(e,r){return l().AES.encrypt(e,r).toString()}function y(e,r){const t=l().AES.decrypt(e,r).toString(l().enc.Utf8);if(!t)throw new Error("Decryption failed - invalid password");return t}function w(e){return new d.u(e).address}var m=t(60894),h=t(20238),N=t(14304),A=t(52834),S=t(20415);const _=(0,N.vP)({networks:[{name:"mainnet",rpcUrl:"https://mainnet.infura.io/v3/YOUR_INFURA_KEY"},{name:"sepolia",rpcUrl:"https://sepolia.infura.io/v3/YOUR_INFURA_KEY"}]}),R=new h.xR(_);function C(e,r=1){const t=e.startsWith("0x")?e.slice(2):e;return new m.z({identifier:S.K("0x"+t),privateKey:t,chainNameOrId:r})}function g(e,r=1){return`did:ethr:${1===r?"":`0x${r.toString(16)}:`}${e}`}async function v(e){try{const r=await R.resolve(e);return r.didDocument?r.didDocument:null}catch(e){return console.error("DID resolution failed:",e),null}}var I=t(61036),L=t(7085);const O={[a.ETHEREUM_MAINNET]:{chainId:1,name:"Ethereum Mainnet",rpcUrl:"https://mainnet.infura.io/v3/YOUR_INFURA_KEY",explorer:"https://etherscan.io",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18}},[a.ETHEREUM_SEPOLIA]:{chainId:11155111,name:"Sepolia Testnet",rpcUrl:"https://sepolia.infura.io/v3/YOUR_INFURA_KEY",explorer:"https://sepolia.etherscan.io",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18}},[a.POLYGON]:{chainId:137,name:"Polygon",rpcUrl:"https://polygon-rpc.com",explorer:"https://polygonscan.com",nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18}},[a.BSC]:{chainId:56,name:"Binance Smart Chain",rpcUrl:"https://bsc-dataseed.binance.org",explorer:"https://bscscan.com",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18}}};function b(e){const r=O[e];return new I.FR(r.rpcUrl)}let D=null,k=null,U=null;function M(){U&&clearTimeout(U),U=setTimeout(()=>{x()},3e5)}function P(){M()}function x(){D=null,k=null,U&&(clearTimeout(U),U=null),chrome.runtime.sendMessage({type:"WALLET_LOCKED"})}async function G(){return(await chrome.storage.local.get("cryptexa_store")).cryptexa_store||null}async function K(e){await chrome.storage.local.set({cryptexa_store:e})}chrome.runtime.onMessage.addListener((e,r,t)=>((async()=>{let r;switch(e.type){case n.CREATE_WALLET:r=await async function(e){try{const r=s.we(128),t=p(r,u),n=p(r,E),o=w(t),c=(C(n),g(o)),i={encryptedSeed:T(r,e),encryptedDIDKey:T(n,e),wallets:[{address:o,publicKey:o,encryptedPrivateKey:T(t,e),derivationPath:u,network:a.ETHEREUM_MAINNET}],did:c,didDocument:await v(c)||void 0,credentials:[],settings:{lockTimeout:5,selectedNetwork:a.ETHEREUM_MAINNET,defaultCurrency:"USD",autoLockEnabled:!0}};return await K(i),D=r,k=n,M(),{success:!0,data:{address:o,mnemonic:r,did:c}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to create wallet"}}}(e.payload.password);break;case n.RESTORE_WALLET:r=await async function(e,r){try{if(!f(e))return{success:!1,error:"Invalid mnemonic phrase - checksum verification failed"};const t=p(e,u),n=p(e,E),s=w(t),o=g(s),c={encryptedSeed:T(e,r),encryptedDIDKey:T(n,r),wallets:[{address:s,publicKey:s,encryptedPrivateKey:T(t,r),derivationPath:u,network:a.ETHEREUM_MAINNET}],did:o,credentials:[],settings:{lockTimeout:5,selectedNetwork:a.ETHEREUM_MAINNET,defaultCurrency:"USD",autoLockEnabled:!0}};return await K(c),D=e,k=n,M(),{success:!0,data:{address:s,did:o}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to restore wallet"}}}(e.payload.mnemonic,e.payload.password);break;case n.UNLOCK_WALLET:r=await async function(e){try{const r=await G();if(!r)return{success:!1,error:"No wallet found"};const t=y(r.encryptedSeed,e),a=y(r.encryptedDIDKey,e);return D=t,k=a,M(),{success:!0,data:{address:r.wallets[0].address,did:r.did||""}}}catch(e){return{success:!1,error:"Invalid password"}}}(e.payload.password);break;case n.LOCK_WALLET:x(),r={success:!0};break;case n.GET_BALANCE:r=await async function(e,r){try{P();const t=await async function(e,r){const t=b(r),a=await t.getBalance(e);return L.ck(a)}(e,r);return{success:!0,data:{balance:t,symbol:"ETH"}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get balance"}}}(e.payload.address,e.payload.network);break;case n.SEND_TRANSACTION:r=await async function(e,r,t,a){try{if(!D)return{success:!1,error:"Wallet is locked"};P();const n=await G();if(!n)return{success:!1,error:"No wallet found"};const s=y(n.wallets[0].encryptedPrivateKey,a),o=await async function(e,r,t,a){const n=b(a),s=new d.u(e,n);return(await s.sendTransaction({to:r,value:L.g5(t),gasLimit:void 0})).hash}(s,e,r,t);return{success:!0,data:{txHash:o}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Transaction failed"}}}(e.payload.to,e.payload.amount,e.payload.network,e.payload.password);break;case n.GET_TRANSACTIONS:r=await async function(e,r){try{P();const t=await async function(e,r,t=50){var a,n;const s=b(r),o=await s.getBlockNumber(),c=[],i=Math.min(1e3,o);for(let r=0;r<i&&c.length<t;r++){const i=o-r;try{const r=await s.getBlock(i,!0);if(r&&r.prefetchedTransactions)for(const o of r.prefetchedTransactions)if(o.from.toLowerCase()===e.toLowerCase()||(null===(a=o.to)||void 0===a?void 0:a.toLowerCase())===e.toLowerCase()){const e=await s.getTransactionReceipt(o.hash);if(c.push({hash:o.hash,from:o.from,to:o.to||"",value:L.ck(o.value),asset:"ETH",timestamp:1e3*r.timestamp,status:1===(null==e?void 0:e.status)?"confirmed":"failed",gasUsed:null==e?void 0:e.gasUsed.toString(),gasPrice:null===(n=o.gasPrice)||void 0===n?void 0:n.toString(),blockNumber:o.blockNumber||void 0}),c.length>=t)break}}catch(e){console.error(`Error fetching block ${i}:`,e)}}return c.sort((e,r)=>r.timestamp-e.timestamp)}(e,r);return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get transactions"}}}(e.payload.address,e.payload.network);break;case n.CREATE_DID:r=await async function(){try{if(!k)return{success:!1,error:"Wallet is locked"};P();const e=await G();if(!e)return{success:!1,error:"No wallet found"};const r=g(e.wallets[0].address);return e.did=r,await K(e),{success:!0,data:{did:r}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to create DID"}}}();break;case n.RESOLVE_DID:r=await async function(e){try{P();const r=await v(e);return r?{success:!0,data:r}:{success:!1,error:"DID not found"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to resolve DID"}}}(e.payload.did);break;case n.STORE_CREDENTIAL:r=await async function(e){try{P();const r=await G();if(!r)return{success:!1,error:"No wallet found"};const t=await async function(e){try{if(!e.proof||!e.proof.jws)return{verified:!1,error:"No proof found in credential"};const r=await(0,A.RO)(e.proof.jws,{resolver:R});return e.expirationDate&&new Date(e.expirationDate)<new Date?{verified:!1,error:"Credential has expired"}:{verified:!!r}}catch(e){return{verified:!1,error:e instanceof Error?e.message:"Verification failed"}}}(e);return t.verified?(r.credentials.push(e),await K(r),{success:!0}):{success:!1,error:`Credential verification failed: ${t.error}`}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to store credential"}}}(e.payload.credential);break;case n.GET_CREDENTIALS:r=await async function(){try{P();const e=await G();return e?{success:!0,data:e.credentials}:{success:!1,error:"No wallet found"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get credentials"}}}();break;case n.CREATE_PRESENTATION:r=await async function(e,r,t){try{if(!k)return{success:!1,error:"Wallet is locked"};P();const a=await G();if(!a)return{success:!1,error:"No wallet found"};const n=a.credentials.filter(r=>e.includes(r.id));if(0===n.length)return{success:!1,error:"No matching credentials found"};const s=C(k),o=await async function(e,r,t,a){const n={"@context":["https://www.w3.org/2018/credentials/v1"],type:["VerifiablePresentation"],holder:e.did,verifiableCredential:r},s={vp:n,sub:e.did,nbf:Math.floor(Date.now()/1e3)};t&&(s.nonce=t),a&&(s.aud=a);const o=await(0,A.WJ)(s,{issuer:e.did,signer:e.signer},{alg:"ES256K-R"}),c={type:"JwtProof2020",created:(new Date).toISOString(),proofPurpose:"authentication",verificationMethod:`${e.did}#controller`,jws:o};return Object.assign(Object.assign({},n),{proof:c})}(s,n,r,t);return{success:!0,data:o}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to create presentation"}}}(e.payload.credentialIds,e.payload.challenge,e.payload.domain);break;case n.SIGN_CHALLENGE:r=await async function(e,r){try{if(!k)return{success:!1,error:"Wallet is locked"};P();const t=C(k),a=await async function(e,r,t){return await(0,A.WJ)({challenge:r,aud:t,sub:e.did,nbf:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+300},{issuer:e.did,signer:e.signer},{alg:"ES256K-R"})}(t,e,r);return{success:!0,data:{jwt:a}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to sign challenge"}}}(e.payload.challenge,e.payload.domain);break;default:r={success:!1,error:"Unknown message type"}}t(r)})(),!0)),chrome.alarms.create("autoLock",{periodInMinutes:1}),chrome.alarms.onAlarm.addListener(e=>{"autoLock"===e.name&&D&&M()}),console.log("Cryptexa Wallet Service Worker initialized")},47790:()=>{},50477:()=>{},51069:()=>{},63779:()=>{},64688:()=>{},66089:()=>{},73776:()=>{},77199:()=>{},77965:()=>{},78982:()=>{},79368:()=>{},79838:()=>{}},t={};function a(e){var n=t[e];if(void 0!==n)return n.exports;var s=t[e]={id:e,loaded:!1,exports:{}};return r[e].call(s.exports,s,s.exports,a),s.loaded=!0,s.exports}a.m=r,a.amdO={},e=[],a.O=(r,t,n,s)=>{if(!t){var o=1/0;for(d=0;d<e.length;d++){for(var[t,n,s]=e[d],c=!0,i=0;i<t.length;i++)(!1&s||o>=s)&&Object.keys(a.O).every(e=>a.O[e](t[i]))?t.splice(i--,1):(c=!1,s<o&&(o=s));if(c){e.splice(d--,1);var l=n();void 0!==l&&(r=l)}}return r}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[t,n,s]},a.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return a.d(r,{a:r}),r},a.d=(e,r)=>{for(var t in r)a.o(r,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.j=471,(()=>{var e={471:0};a.O.j=r=>0===e[r];var r=(r,t)=>{var n,s,[o,c,i]=t,l=0;if(o.some(r=>0!==e[r])){for(n in c)a.o(c,n)&&(a.m[n]=c[n]);if(i)var d=i(a)}for(r&&r(t);l<o.length;l++)s=o[l],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},t=self.webpackChunkcryptexa_wallet=self.webpackChunkcryptexa_wallet||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})(),a.nc=void 0;var n=a.O(void 0,[121],()=>a(29198));n=a.O(n)})();